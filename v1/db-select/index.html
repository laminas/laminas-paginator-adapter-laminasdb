<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="laminas-db adapters for laminas-paginator"> 

    
    
        
    
    <meta name="docsearch:version" content="1.0.0,latest">
    <meta name="docsearch:language" content="en">
    <meta name="docsearch:component" content="laminas-paginator-adapter-laminasdb">

    <link rel="canonical" href="https://docs.laminas.dev/laminas-paginator-adapter-laminasdb/v1/db-select/">
    <link rel="shortcut icon" href="https://docs.laminas.dev/img/trademark-laminas-foundation-rgb.svg">

    <title>DbSelect Adapter - laminas-paginator-adapter-laminasdb - Laminas Docs</title>

    <link rel="stylesheet" href="https://docs.laminas.dev/css/styles.css">
    
</head>
<body id="page-top" class="components" data-spy="scroll" data-target=".toc" data-offset="20">

    
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
        
        <a class="logo-link navbar-brand" href="https://getlaminas.org/" data-tooltip data-placement="bottom" title="Go to the Laminas homepage">
            <img src="https://docs.laminas.dev/img/laminas-foundation-white.svg" height="28" alt="Laminas">
        </a>
        <a class="navbar-title" href="https://docs.laminas.dev/" data-tooltip data-placement="bottom" title="Go to the Laminas Documentation">
            Documentation
        </a>

        
        <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">

            
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <div class="dropdown sub-project-selector">
                        <a class="dropdown-toggle nav-link" data-toggle="dropdown" aria-expanded="false">
                            All Docs
                        </a>
                        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                            <a href="https://docs.mezzio.dev/" class="dropdown-item">
                                <div class="row align-items-center">
                                    <div class="col-md-4 col-sm-12">
                                        <img src="https://docs.laminas.dev/img/laminas-mezzio-rgb.svg">
                                    </div>
                                    <div class="col-md-8 col-sm-12">
                                        <strong>Mezzio</strong><br>
                                        PSR-15 Middleware in Minutes
                                    </div>
                                </div>
                            </a>
                            <a href="https://docs.laminas.dev/components/" class="dropdown-item">
                                <div class="row align-items-center">
                                    <div class="col-md-4 col-sm-12">
                                        <img src="https://docs.laminas.dev/img/laminas-components-rgb.svg">
                                    </div>
                                    <div class="col-md-8 col-sm-12">
                                        <strong>Components</strong><br>
                                        Components for Enterprise Applications
                                    </div>
                                </div>
                            </a>
                            <a href="https://docs.laminas.dev/mvc" class="dropdown-item">
                                <div class="row align-items-center">
                                    <div class="col-md-4 col-sm-12">
                                        <img src="https://docs.laminas.dev/img/laminas-mvc-rgb.svg">
                                    </div>
                                    <div class="col-md-8 col-sm-12">
                                        <strong>MVC</strong><br>
                                        MVC for Enterprise Applications
                                    </div>
                                </div>
                            </a>
                            <a href="https://api-tools.getlaminas.org/documentation" class="dropdown-item">
                                <div class="row align-items-center">
                                    <div class="col-md-4 col-sm-12">
                                        <img src="https://docs.laminas.dev/img/laminas-api-tools-rgb.svg">
                                    </div>
                                    <div class="col-md-8 col-sm-12">
                                        <strong>API Tools</strong><br>
                                        Build RESTful APIs in Minutes
                                    </div>
                                </div>
                            </a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item dropdown-item--secondardy" href="https://docs.laminas.dev/migration/">
                                <div class="row align-items-center">
                                    <div class="col-md-8 offset-md-4 col-sm-12">
                                        Migration to Laminas
                                    </div>
                                </div>
                            </a>
                            <a class="dropdown-item dropdown-item--secondardy" href="https://docs.laminas.dev/tutorials/">
                                <div class="row align-items-center">
                                    <div class="col-md-8 offset-md-4 col-sm-12">
                                        Tutorials
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </li>
                <li class="nav-item">
                    <a href="https://getlaminas.org/participate" class="nav-link">Community</a>
                </li>
            </ul>

            
            
                <div class="d-block d-sm-none">
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="../..">laminas-paginator-adapter-laminasdb</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            

                
                
                    
                        
    <li class="subnavigation__list-item ">
        <a href="../intro/" class="subnavigation__link">Introduction</a>
    </li>

                    
                        
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">DbSelect Adapter</a>
    </li>

                    
                        
    <li class="subnavigation__list-item ">
        <a href="../db-table-gateway/" class="subnavigation__link">DbTableGateway Adapter</a>
    </li>

                    
                
            
        </ul>
    </div>

                </div>
            

            
            <div class="d-block d-sm-none">
                <div class="component-selector">
    
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
            </div>
        </div>
    </div>
</nav>

    
    <header class="header">
    <div class="container">
        <div class="row">

            
            <div class="col-8">
                <h1 class="header__title">
                    Components

                    
                        <small class="header__subtitle">laminas-paginator-adapter-laminasdb</small>
                    
                </h1>
            </div>

            
            <div class="col-4 text-right">
                
                    

                    <a href="#" class="header__link header__link--search" data-toggle="modal" data-target="#mkdocs_search_modal" title="Open search">
                        <i class="fa fa-search"></i> Search
                    </a>
                    <a href="https://github.com/laminas/laminas-paginator-adapter-laminasdb" class="header__link header__link--github" title="Go to repository of laminas-paginator-adapter-laminasdb">
                        <i class="fab fa-github"></i> GitHub
                    </a>
                
            </div>
        </div>
    </div>
</header>

    
    <div class="container">
        <div class="row">
            <div class="col-md-9 col-sm-12 content" role="main">
                
                
                    
    

    
    
        <div class="toc">
            <h6 class="toc__headline">On this page</h6>
            <ul class="toc__list">
                
                    <li class="toc__entry">
                        <a href="#creating-an-instance" class="toc__link nav-link">Creating An Instance</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#modifying-result-items" class="toc__link nav-link">Modifying Result Items</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#counting-total-items" class="toc__link nav-link">Counting Total Items</a>
                    </li>
                
            </ul>
        </div>
    

                

                
                    <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        
            <li class="breadcrumb-item"><a href="https://docs.laminas.dev/">Overview</a></li>
            <li class="breadcrumb-item"><a href="https://docs.laminas.dev/components/">Components</a></li>

            
                <li class="breadcrumb-item"><a href="../..">laminas-paginator-adapter-laminasdb</a></li>

                
                    
                        
                        
                    
                

                <li class="breadcrumb-item active" aria-current="page">DbSelect Adapter</li>
            
        
    </ol>
</nav>






    
    

    <h1 id="the-dbselect-adapter">The DbSelect adapter</h1>
<p>The <code>DbSelect</code> adapter allows you to provide a <code>Select</code> statement for pulling a dataset, and optionally a <code>Select</code> statement for pulling a count of results, and an optional <code>Select</code> statement for providing an overall count of items.</p>
<p>The adapter does <strong>not</strong> fetch all records from the database in order to count them, nor does it run any queries immediately.
If no <code>Select</code> instance was provided for counting results, the adapter manipulates the original <code>Select</code> to produce a corresponding <code>COUNT</code> query, and uses the new query to get the number of rows.
While this approach requires an extra round-trip to the database, doing so is still many times faster than fetching an entire result set and using <code>count()</code>, especially with large collections of data.</p>
<h2 id="creating-an-instance">Creating An Instance</h2>
<p>The <code>DbSelect</code> constructor has the following signature:</p>
<pre class="highlight"><code class="language-php">public function __construct(
    \Laminas\Db\Sql\Select $select,
    \Laminas\Db\Adapter\AdapterInterface|\Laminas\Db\Sql\Sql $adapterOrSqlObject,
    ?\Laminas\Db\ResultSet\ResultSetInterface $resultSetPrototype = null,
    ?\Laminas\Db\Sql\Select $countSelect = null
)</code></pre>
<p>The first argument is the <code>Select</code> to use when retrieving results to paginate.
The next argument, <code>$adapterOrSqlObject</code>, provides access to the adapter so it can execute the <code>Select</code> statement against the actual database.
The third argument is a specific result set type to use on results returned from the <code>Select</code> operation; these allow you to customize the items returned, if desired.
(See the <a href="https://docs.laminas.dev/laminas-db/result-set/">laminas-db ResultSet documentation for more details</a>.)
The fourth argument allows you to specify a specific <code>Select</code> instance to use to provide a total count of results.</p>
<h3 id="using-the-adapterpluginmanager">Using the AdapterPluginManager</h3>
<p>By default, when pulling the <code>Laminas\Paginator\AdapterPluginManager</code> from the application DI container, it is aware of the <code>DbSelect</code> adapter.
You can retrieve an instance from the plugin manager via its <code>get()</code> method, passing any constructor arguments you want to provide via an array as the second argument:</p>
<pre class="highlight"><code class="language-php">use Laminas\Paginator\AdapterPluginManager;
use Laminas\Paginator\Adapter\LaminasDb\DbSelect;

// $container is the PSR-11 container associated with the application.
$pluginManager = $container-&gt;get(AdapterPluginManager::class);

// $select is the laminas-db Select instance for retrieving items
// $dbAdapter is the laminas-db adapter you want to use
$adapter = $pluginManager-&gt;get(DbSelect::class, [
    $select,
    $dbAdapter
]);</code></pre>
<p>All required arguments to the constructor must be passed in the array, and they will be passed in the same order to the constructor.</p>
<h2 id="modifying-result-items">Modifying Result Items</h2>
<p>The default <code>Laminas\Db\ResultSet\ResultSet</code> used when iterating over items returns each item as an associative array.
If you wish to filter out specific fields, modify the column names, or return something other than an associative array, you will need to provide a different <code>Laminas\Db\ResultSet\ResultSetInterface</code> implementation to the constructor, or extend the adapter and override the <code>getItems()</code> method.</p>
<h3 id="providing-an-alternate-resultset">Providing an Alternate ResultSet</h3>
<p>You can override the default <code>ResultSet</code> implementation by passing an object implementing <code>Laminas\Db\ResultSet\ResultSetInterface</code> as the third constructor argument to the <code>DbSelect</code> adapter:</p>
<pre class="highlight"><code class="language-php">use Laminas\Db\ResultSet\HydratingResultSet;
use Laminas\Paginator\Adapter\LaminasDb\DbSelect;
use Laminas\Paginator\Paginator;

// $objectPrototype is an instance of our custom entity
// $hydrator is a custom hydrator for our entity
// (implementing Laminas\Hydrator\HydratorInterface)
$resultSet = new HydratingResultSet($hydrator, $objectPrototype);

// $query is our Select statement
// $dbAdapter is the laminas-db adapter instance
$adapter   = new DbSelect($query, $dbAdapter, $resultSet)
$paginator = new Laminas\Paginator\Paginator($adapter);</code></pre>
<p>Now when we iterate over <code>$paginator</code>, we will get instances of our custom entity instead of associative arrays.</p>
<h3 id="overriding-getitems">Overriding getItems</h3>
<p>If you want to manipulate the results manually, you can extend the adapter and override the <code>getItems()</code> method directly.
The following example demonstrates using an <code>array_map()</code> operation on results in order to cast the rows to an object.
It assumes the class <code>App\Fuzz</code> exists, and defines a static method <code>fromArray()</code> that will allow casting an array to an <code>App\Fuzz</code> instance.</p>
<pre class="highlight"><code class="language-php">namespace App;

use Laminas\Paginator\Adapter\LaminasDb\DbSelect;

class FuzzDbSelect extends DbSelect
{
    public function getItems($offset, $itemCountPerPage)
    {
        return array_map(
            function (array $row): Fuzz {
              return Fuzz::fromArray($row);
            },
            parent::getItems($offset, $itemCountPerPage)
        );
    }
}</code></pre>
<h2 id="counting-total-items">Counting Total Items</h2>
<p>The database adapter will try and build the most efficient query that will execute on pretty much any modern database.
However, depending on your database or even your own schema setup, there might be more efficient ways to get a rowcount.</p>
<p>There are two approaches for doing this: providing an additional <code>Select</code> instance for retrieving a count to the constructor, or overriding the <code>count()</code> method.</p>
<h3 id="providing-a-select-for-counting">Providing a Select for Counting</h3>
<p>You can pass an additional <code>Laminas\Db\Sql\Select</code> object as the fourth constructor argument to the <code>DbSelect</code> adapter to implement a custom count query.</p>
<p>For example, if you keep track of the count of blog posts in a separate table, you could achieve a faster count query with the following setup:</p>
<pre class="highlight"><code class="language-php">use Laminas\Db\Sql\Select;
use Laminas\Paginator\Adapter\LaminasDb\DbSelect;
use Laminas\Paginator\Paginator;

$countQuery = new Select();
$countQuery
    -&gt;from('item_counts')
    -&gt;columns([DbSelect::ROW_COUNT_COLUMN_NAME =&gt; 'post_count']);

// $query is the Select for retrieving items
// $dbAdapter is the laminas-db adapter
$adapter   = new DbSelect($query, $dbAdapter, null, $countQuery);
$paginator = new Paginator($adapter);</code></pre>
<p>This approach will probably not give you a huge performance gain on small collections and/or simple select queries.
However, with complex queries and large collections, a similar approach could give you a significant performance boost.</p>
<h3 id="overriding-the-count-method">Overriding the Count Method</h3>
<p>The following example demonstrates extending the <code>DbSelect</code> adapter to override the <code>count()</code> method.</p>
<pre class="highlight"><code class="language-php">namespace App;

use Laminas\Db\Sql\Select;
use Laminas\Paginator\Adapter\LaminasDb\DbSelect;

class MyDbSelect extends DbSelect
{
    public function count()
    {
        if ($this-&gt;rowCount) {
            return $this-&gt;rowCount;
        }

        $select = new Select();
        $select
            -&gt;from('item_counts')
            -&gt;columns(['c'=&gt;'post_count']);

        $statement = $this-&gt;sql-&gt;prepareStatementForSqlObject($select);
        $result    = $statement-&gt;execute();
        $row       = $result-&gt;current();
        $this-&gt;rowCount = $row['c'];

        return $this-&gt;rowCount;
    }
}

// $query is the Select for retrieving items
// $dbAdapter is the laminas-db adapter
$adapter = new MyDbSelect($query, $dbAdapter);</code></pre>




    <nav>
    <ul class="page-nav hidden-print">

        
        <li class="page-nav__item">
            
                <a rel="prev" class="page-nav__link page-nav__link--prev" href="../intro/">
                    <small class="page-nav__label">Previous</small>
                    <i class="fa fa-chevron-left"></i>
                    Introduction
                </a>
            
        </li>

        
        <li class="page-nav__item">
            
                <a rel="next" class="page-nav__link page-nav__link--next" href="../db-table-gateway/">
                    <small class="page-nav__label">Next</small>
                    DbTableGateway Adapter
                    <i class="fa fa-chevron-right"></i>
                </a>
            
        </li>
    </ul>
</nav>



                
            </div>
            <div class="col-md-3 col-sm-12 sidebar">
                <div class="donation-banner">
    <a href="https://getlaminas.org/support/">
        <h2>Donate</h2>
        <p>Support Laminas Developers Directly</p>
        <img src="https://funding.communitybridge.org/assets/cb-f-horizontal-white.svg">
    </a>
</div>

                
                    <div class="component-selector">
    
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="../..">laminas-paginator-adapter-laminasdb</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            

                
                
                    
                        
    <li class="subnavigation__list-item ">
        <a href="../intro/" class="subnavigation__link">Introduction</a>
    </li>

                    
                        
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">DbSelect Adapter</a>
    </li>

                    
                        
    <li class="subnavigation__list-item ">
        <a href="../db-table-gateway/" class="subnavigation__link">DbTableGateway Adapter</a>
    </li>

                    
                
            
        </ul>
    </div>

                    
                
            </div>
        </div>
    </div>

    
    <footer class="footer">
    <div class="container">

        
        <div class="row">
            <div class="col-md-12 text-center">
                <a class="footer__button" href="#page-top"><i class="fa fa-chevron-up" aria-hidden="true"></i></a>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <h5>Laminas</h5>
                <ul>
                    <li>Laminas Project <a href="https://getlaminas.org/">The new foundation for the community-supported, open source continuation of Zend Framework</a></li>
                    <li>Laminas Components and MVC <a href="https://docs.laminas.dev/">Components and MVC for enterprise applications</a></li>
                    <li>Mezzio <a href="https://docs.mezzio.dev/">PSR-15 middleware in minutes</a></li>
                    <li>Laminas API Tools <a href="https://api-tools.getlaminas.org/">Build RESTful APIs in minutes</a></li>
                </ul>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="row">

                    
                    <div class="col-md-4">
                        <h4 class="footer__headline">Support</h4>
                        <ul class="support__list">
                            <li class="support__list-item">
                                <a href="https://discourse.laminas.dev" class="support__link" title="Forum"><i class="fa fa-comments"></i></a>
                            </li>
                            <li class="support__list-item">
                                <a href="https://laminas.dev/chat" class="support__link" title="Chat"><i class="fab fa-slack"></i></a>
                            </li>
                            <li class="support__list-item">
                                <a href="https://github.com/laminas" class="support__link" title="Github"><i class="fab fa-github"></i></a>
                            </li>
                            <li class="support__list-item">
                                <a href="https://phpc.social/@getlaminas" class="support__link" title="Mastodon"><i class="fab fa-mastodon"></i></a>
                            </li>
                            <li class="support__list-item">
                                <a href="https://getlaminas.org/blog/rss.xml" class="support__link" title="Blog feed"><i class="fa fa-rss"></i></a>
                            </li>
                            <li class="support__list-item">
                                <a href="https://getlaminas.org/security/feed" class="support__link" title="Security feed"><i class="fa fa-rss-square"></i></a>
                            </li>
                        </ul>
                    </div>

                    
                    <div class="col-md-4">
                        <h4 class="footer__headline">License</h4>
                        <p>
                            Code licensed under <a
                                href="https://github.com/laminas/laminas-paginator-adapter-laminasdb/blob/-/LICENSE.md">BSD 3-Clause</a>.
                        </p>
                    </div>

                    
                    <div class="col-md-4">
                        <h4 class="footer__headline">Copyright</h4>
                        <p>
                            <!--Built with love by the Laminas team with the help of our
                            <a href="https://github.com/laminas/laminas-paginator-adapter-laminasdb/graphs/contributors">contributors</a>.<br>-->
                            &copy; 2024 <a href="https://getlaminas.org/">Laminas Project</a> a Series of LF Projects, LLC.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>

    <script>
        let base_url = '../..',
            project  = "components",
            siteName = 'laminas-paginator-adapter-laminasdb';
    </script>
    <script src="https://docs.laminas.dev/js/scripts.js"></script>
    
        <script src="../../search/main.js"></script>
    

    
    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Search</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                    <span class="sr-only">Close</span>
                </button>
            </div>
            <div class="modal-body">
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search in laminas-paginator-adapter-laminasdb" id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
        </div>
    </div>
</div>
</body>


</html>
